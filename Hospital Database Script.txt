# Script to Create Hospital Database
# Version 2.0.1
# Creating Date 02/10/2019
# Last Updated On 02/12/2019	

# Has Gone Through Testing
# Not Final Draft Of Script
# How to Establish Super/Sub Data (Still Remain)
# Runs Just Copy All And Run on MySQL

DROP TABLE IF EXISTS DOCTOR_PATIENT;
DROP TABLE IF EXISTS TESTS;
DROP TABLE IF EXISTS DIAGNOSIS;
DROP TABLE IF EXISTS MEDICATION_PRESCRIBED;
DROP TABLE IF EXISTS MEDICATION;
DROP TABLE IF EXISTS PATIENT;
DROP TABLE IF EXISTS BILL;
DROP TABLE IF EXISTS CAFETERIA_STAFF;
DROP TABLE IF EXISTS CAFETERIA;
DROP TABLE IF EXISTS STAFF;
DROP TABLE IF EXISTS DOCTOR;
DROP TABLE IF EXISTS WORKER;
DROP TABLE IF EXISTS DEPARTMENT;

# Checked 
CREATE TABLE DEPARTMENT (
		Department_ID			TINYINT NOT NULL,
		Workers 			SMALLINT,
		Building_Location		VARCHAR(10),
	CONSTRAINT Department_PK PRIMARY KEY (Department_ID)
);

# Checked
CREATE TABLE WORKER (
		Worker_ID 			SMALLINT NOT NULL,
		fname 				VARCHAR(10),
		lname 				VARCHAR(10),
		Gender 				CHAR(1),
		telephone 			VARCHAR(14),
		Salary 				INT,
	CONSTRAINT Worker_PK PRIMARY KEY (Worker_ID)
);

# Checked
CREATE TABLE DOCTOR (
		Doctor_ID			SMALLINT NOT NULL, 
		Field				VARCHAR(20),
		Degree				VARCHAR(30),
		Department_ID			TINYINT NOT NULL,
		D_Worker_ID			SMALLINT NOT NULL,
	CONSTRAINT Doctor_PK PRIMARY KEY (Doctor_ID),
	CONSTRAINT Doctor_FK1 FOREIGN KEY (Department_ID) REFERENCES DEPARTMENT(Department_ID),
	CONSTRAINT Doctor_FK2 FOREIGN KEY (D_Worker_ID) REFERENCES WORKER(Worker_ID)
	#Needs some Edits *
);

# Check
CREATE TABLE STAFF (
		Staff_ID			SMALLINT NOT NULL, 
		Job_Title			VARCHAR(15),
		S_Worker_ID			SMALLINT,
		
	CONSTRAINT STAFF_PK PRIMARY KEY (Staff_ID),
	CONSTRAINT STAFF_FK1 FOREIGN KEY (S_Worker_ID) REFERENCES Worker (Worker_ID)
	#Needs some Edits *
);

# Checked
CREATE TABLE CAFETERIA (
		Cafeteria_ID			SMALLINT NOT NULL, 
		Food_Type			VARCHAR(15),
		Seating				SMALLINT,
		
	CONSTRAINT CAFETERIA_PK PRIMARY KEY (Cafeteria_ID)
);

# Checked
CREATE TABLE CAFETERIA_STAFF (
		Staff_ID 			SMALLINT NOT NULL,
		Cafeteria_ID			SMALLINT NOT NULL,
		Position			VARCHAR(15),
		
	CONSTRAINT CAFETERIA_STAFF_FK1 FOREIGN KEY (Staff_ID) REFERENCES STAFF (Staff_ID),
	CONSTRAINT CAFETERIA_STAFF_FK2 FOREIGN KEY (Cafeteria_ID) REFERENCES CAFETERIA (Cafeteria_ID)
);

# Checked
CREATE TABLE BILL (
		Bill_ID				INT NOT NULL,
		Tests				VARCHAR(15),
		Treatment			VARCHAR(20),
		Time_Admitted			DATETIME,
		Prescription			VARCHAR(20),
		
	CONSTRAINT BILL_PK PRIMARY KEY (Bill_ID)
);

# Checked
CREATE TABLE PATIENT (
		Patient_ID			INT NOT NULL,	
		fname				VARCHAR(10),
		lname 				VARCHAR(10),
		Address				TEXT,
		telephone			VARCHAR(14),
		Gender				VARCHAR(5),
		Age				SMALLINT,
		Blood_Type			VARCHAR(5),
		Cafeteria_ID			SMALLINT NOT NULL,
		Bill_ID				INT NOT NULL,
		
	CONSTRAINT PATIENT_PK PRIMARY KEY (Patient_ID),
	CONSTRAINT PATIENT_FK1 FOREIGN KEY (Cafeteria_ID) REFERENCES CAFETERIA(Cafeteria_ID),
	CONSTRAINT PATIENT_FK2 FOREIGN KEY (Bill_ID) REFERENCES BILL(Bill_ID)
);


# Checked
CREATE TABLE MEDICATION (
		Medication_ID			INT NOT NULL,
		Doses				TINYINT,
		Expiration_Date			DATE,
		
	CONSTRAINT MEDICATION_PK PRIMARY KEY (Medication_ID)
);


# Checked
CREATE TABLE MEDICATION_PRESCRIBED (
		Prescription_ID			INT NOT NULL,
		Medication_ID			INT NOT NULL,
		Patient_ID			INT NOT NULL,
		
	CONSTRAINT MEDICTION_PERSCRIBED_PK PRIMARY KEY (Prescription_ID),
	CONSTRAINT MEDICTION_PERSCRIBED_FK1 FOREIGN KEY (Medication_ID) REFERENCES MEDICATION (Medication_ID),
	CONSTRAINT MEDICTION_PERSCRIBED_FK2 FOREIGN KEY (Patient_ID) REFERENCES PATIENT (Patient_ID)
);

# Checked
CREATE TABLE DIAGNOSIS (
		Illness				VARCHAR(15) NOT NUll,
		Doctor_ID			SMALLINT NOT NULL,
		Patient_ID			INT NOT NULL,
		
	CONSTRAINT DIAGNOSIS_PK PRIMARY KEY (Illness),
	CONSTRAINT DIAGNOSIS_FK1 FOREIGN KEY (Doctor_ID) REFERENCES DOCTOR(Doctor_ID),
	CONSTRAINT DIAGNOSIS_FK2 FOREIGN KEY (Patient_ID) REFERENCES PATIENT(Patient_ID)
);

# Checked
CREATE TABLE TESTS (
		Test_ID				INT NOT NUll,
		Result				TINYINT(1),
		Illness				VARCHAR(15),
		Doctor_ID			SMALLINT NOT NULL,
		Patient_ID			INT NOT NULL,
		
	CONSTRAINT TESTS_PK PRIMARY KEY (Test_ID),
	CONSTRAINT TESTS_FK1 FOREIGN KEY (Doctor_ID) REFERENCES DOCTOR(Doctor_ID),
	CONSTRAINT TESTS_FK2 FOREIGN KEY (Illness) REFERENCES DIAGNOSIS(Illness),
	CONSTRAINT TESTS_FK3 FOREIGN KEY (Patient_ID) REFERENCES PATIENT(Patient_ID)
);

# Checked
CREATE TABLE DOCTOR_PATIENT (
		Doctor_ID			SMALLINT NOT NULL,
		Patient_ID			INT NOT NULL,
		Time				DATETIME,
		
	CONSTRAINT DOCTOR_PATIENT_PK PRIMARY KEY (Doctor_ID),
	CONSTRAINT DOCTOR_PATIENT_FK1 FOREIGN KEY (Doctor_ID) REFERENCES DOCTOR(Doctor_ID),
	CONSTRAINT DOCTOR_PATIENT_FK2 FOREIGN KEY (Patient_ID) REFERENCES PATIENT(Patient_ID)
);
